<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Haber Detayı</title>
<link rel="stylesheet" href="../style.css">
</head>
<body>
<main id="haberDetay"></main>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";

// Firebase yapılandırması
const firebaseConfig = {
  apiKey: "AIzaSyBK6_U6iG0AXgVb3NbNSXhf_2S3fWw9wsc",
  authDomain: "azadhaber1.firebaseapp.com",
  databaseURL: "https://azadhaber1-default-rtdb.firebaseio.com",
  projectId: "azadhaber1",
  storageBucket: "azadhaber1.appspot.com",
  messagingSenderId: "307978936562",
  appId: "1:307978936562:web:7eb007183210681d306b"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

// URL parametresinden slug'ı almak
function getSlug() {
    const params = new URLSearchParams(window.location.search);
    return params.get("slug");  // URL'deki slug parametresini döndür
}

const slug = getSlug();  // URL'den slug'ı al
const main = document.getElementById("haberDetay");  // haberDetay alanı

// Kategoriler
const kategoriler = ["guncel", "politika", "ekonomi", "spor"];
let bulundu = false;  // Haber bulundu mu?

// Firebase'den haberleri çek ve slug'a göre eşleşme yap
kategoriler.forEach(cat => {
    const newsRef = ref(db, "haberler/" + cat);
    onValue(newsRef, snapshot => {
        snapshot.forEach(child => {
            const h = child.val();  // Her haberin verileri
            if (h.slug === slug) {  // Slug eşleşmesi
                main.innerHTML = `
                    <h1>${h.title}</h1>
                    <img src="${h.image}" alt="Haber Görseli" style="width:100%; max-height:400px; object-fit:cover;">
                    <p>${h.content}</p>
                    <a href="../index.html">Ana Sayfaya Dön</a>
                `;
                bulundu = true;  // Haber bulundu
            }
        });

        // Eğer haber bulunmazsa
        if (!bulundu) {
            main.innerHTML = "<p>Haber bulunamadı!</p>";
        }
    });
});
</script>
</body>
</html>
